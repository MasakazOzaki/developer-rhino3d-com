<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Using NuGet (Windows) with C#</title>
  <meta name="description" content="This guide describes how developers can use the NuGet packages available for RhinoCommon and Grasshopper.  Using C#">

  <!-- OpenGraph for Facebook, Twitter, Slack unfurling -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/guides/rhinocommon/using-nuget/" />
  <meta property="og:title" content="Using NuGet (Windows)" />
  <meta property="og:description" content="This guide describes how developers can use the NuGet packages available for RhinoCommon and Grasshopper." />
  <meta property=”og:site_name” content="developer.rhino3d.com"/>
  <meta property=”og:image” content="http://developer.rhino3d.com/images/rhinodev-logo-unfurl.png"/>

  <!-- twitter card tags additive with the og: tags -->
  <meta name="twitter:domain" value="developer.rhino3d.com" />
  <meta name="twitter:title" value="Using NuGet (Windows)" />
  <meta name="twitter:description" value="This guide describes how developers can use the NuGet packages available for RhinoCommon and Grasshopper." />
  
    <meta name="twitter:image" content="http://developer.rhino3d.com/images/rhinodev-logo-unfurl.png" />
  
  <meta name="twitter:url" value="http://developer.rhino3d.com" />
  
  <meta name="twitter:label1" value="Platform(s)" />
  <meta name="twitter:data1" value="Windows" />
  
  
  <meta name="twitter:label2" value="Language(s)" />
  <meta name="twitter:data2" value="C#" />
  

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/vbnet.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="/5/node_modules/highlightjs-line-numbers.js/dist/highlightjs-line-numbers.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script>hljs.initLineNumbersOnLoad();</script>

  <!-- Overridden theme -->
  <link rel="stylesheet" href="/5/css/main.css">

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <!-- Bootstrap override -->
  <link rel="stylesheet" href="/5/css/bootstrap-override.css">

  <link rel="canonical" href="http://developer.rhino3d.com/5/guides/rhinocommon/using-nuget/">
  <link rel="alternate" type="application/rss+xml" title="Rhino Developer Docs" href="http://developer.rhino3d.com/5/feed.xml" />

  <link rel="shortcut icon" href="http://developer.rhino3d.com/favicon.ico?v=2" />
  <!-- Saving bookmarks to mobile devices -->
  <!-- For non-Retina (@1× display) iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="/5/images/apple-touch-icon-precomposed.png"><!-- 57×57px -->
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/5/images/apple-touch-icon-72x72-precomposed.png">
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/5/images/apple-touch-icon-76x76-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/5/images/apple-touch-icon-114x114-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/5/images/apple-touch-icon-120x120-precomposed.png">
  <!-- For iPad with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/5/images/apple-touch-icon-144x144-precomposed.png">
  <!-- For iPad with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/5/images/apple-touch-icon-152x152-precomposed.png">
  <!-- For iPhone 6 Plus with @3× display: -->
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/5/images/apple-touch-icon-180x180-precomposed.png">
  <!-- For Chrome for Android: -->
  <link rel="icon" sizes="192x192" href="images/touch-icon-192x192.png">

  <!-- Diable crawling until this version is the stable version -->
  <meta name="robots" content="noindex" />

</head>


  <body>

    <!-- Google Tag Manager **This belongs right after the <body> tag**-->
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MWMDKN"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MWMDKN');
    </script>
    <!-- End Google Tag Manager -->


    

<!-- The following are "casts" from the string to number using math filters... -->



<!-- ...but we need to check to see if the original branches were numbers or not... -->









  <div class="version-banner version-banner-warning">

    
      
        
          <strong>WARNING:</strong> You're viewing the older <strong>Rhino 5</strong> version of this page! <a href="/guides/rhinocommon/using-nuget/">View the <strong>Rhino 6</strong> version instead.</a>
        
        
        
      
    
</div>

<!-- Check the version banner for broken links and remove the link if found -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>
$(document).ready(function()
{
  var splitPath = window.location.pathname.split("/");
  var linkURL = "/" + splitPath.splice(2,splitPath.length-2).join("/");

  $.get(linkURL).fail(function ()
  {
    var $aTag = $("div.version-banner > a");
    $aTag.text("View the Rhino 6 site instead.");
    $aTag.attr("href", "/");
  });
});
</script>


    <div class="container">

      <header class="site-header">


    <a class="site-title" href="/5/"><img src="/5/images/rhinodevlogo148x128.png" alt="Rhino Developer Docs" height="48" width="56"></a><a class="site-title" href="/5/">Rhino Developer Docs</a>

    <nav class="site-nav">
      <img class="menu-icon" src="/5/images/gi.svg">
      
      <div class="trigger">
      	<!--<a class="page-link" href="/5/">Welcome</a>-->
        <!-- get current page title and "collection" to figure out which nav
             link should be "active" -->
        
        
        
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
        
          
            
              
                
                  <a class="page-link active" href="/5/guides/">Guides</a>
                
              
            
          
        
          
            
              
                
                  <a class="page-link" href="/5/api/">API</a>
                
              
            
          
        
          
            
              
                
                  <a class="page-link" href="/5/samples/">Samples</a>
                
              
            
          
        
          
            
          
        
          
            
              
                
                  <a class="page-link" href="/5/videos/">Videos</a>
                
              
            
          
        
        <a class="page-link" href="http://discourse.mcneel.com/c/rhino-developer">Forums</a>
        <!-- Google Search Engine -->
        <!-- TODO Move to this site back into the Mcneel search, or use a simple site only search for results -->
        <div id="sitesearch">
            <!-- Google CSE Search Box Begins  -->
            <!-- Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
            <!-- The terms of service are available at https://www.google.com/cse/docs/tos.html -->
            <form id="cref" action="/5/search-results.html">
                <input type="hidden" name="cref" value="007988927381198593803:mcq6pshqsn8" />
                <input id="searchtext" type="text" name="q" size="24" value="" placeholder="search" />
                <input class="searchBox" type="submit" name="sa" size="2" value=" " />
            </form>
        <!-- Google CSE Search Box Ends -->
        </div>
        <!--End of Google Search Engine -->
      </div>
    </nav>

</header>


      <div class="page-content">
        <!--div class="wrapper"-->
          <div class="container-fluid">

<div class="row-fluid">
    <!--Nav Bar -->
    <nav class="col-xs-0 col-md-3 bs-docs-sidebar">
    <ul id="sidebar" class="nav nav-stacked fixed">
        <!-- Find the h2 group and any h3 subgroups -->
        

        
          

          
            
            
            
            
            <li>
              <a href="#why-nuget">Why NuGet?</a>

              
                <ul class="nav nav-stacked">
                  

                  
                    
                    
                    
                    
                    
                    <li>
                        <a href="#advantages">Advantages</a>
                    </li>
                  
                    
                    
                    
                    
                    
                    <li>
                        <a href="#potential-pitfalls">Potential Pitfalls</a>
                    </li>
                  

                </ul>
              

            </li>
          

        
          

          
            
            
            
            
            <li>
              <a href="#getting-started">Getting Started</a>

              
                <ul class="nav nav-stacked">
                  

                  
                    
                    
                    
                    
                    
                    <li>
                        <a href="#step-by-step">Step-by-Step</a>
                    </li>
                  

                </ul>
              

            </li>
          

        
          

          
            
            
            
            
            <li>
              <a href="#related-topics">Related Topics</a>

              

            </li>
          

        
          

          
            
            
            
            
            <li>
              <a href="#footnotes">Footnotes</a>

              

            </li>
          

        
    </ul>
</nav>


    <!--Main Content -->
    <div class="col-xs-12 col-md-9">
      <!--<div class="post">-->

        <article class="post-content">

          <ol class="breadcrumb">
              
              
              
              <li><a href="/5/guides/rhinocommon">RhinoCommon</a></li>

              
                
                  <li class="active">Advanced</li>
                
              
          </ol>

          <h1>Using NuGet (Windows)</h1>

          <p>
  <span class="guide_byline">
    
    
    by
      
        
        
          <a href="https://discourse.mcneel.com/users/fraguada/activity">Luis Fraguada</a>
        
         and
      
        
        
          <a href="https://discourse.mcneel.com/users/will/activity">Will Pearson</a>
        
        
          
    
  </span>

</p>

          <p>This guide describes how developers can use the NuGet packages available for RhinoCommon and Grasshopper.</p>

          <div class="bs-callout bs-callout-danger">

<strong>Warning</strong>: Here be dragons! This is work-in-progress. We have some ideas as to how NuGet packages for <a href="https://www.nuget.org/packages/rhinocommon">RhinoCommon</a> and <a href="https://www.nuget.org/packages/grasshopper">Grasshopper</a> might be useful, but we need developers like yourself to use them and figure out if and how they can improve your development workflows. Currently we're publishing NuGet packages for each Rhino for Windows release.  Rhino for Mac NuGet packages are coming soon.

</div>

<h2 id="why-nuget">Why NuGet?</h2>

<p>In <a href="http://developer.rhino3d.com/5/guides/rhinocommon/your-first-plugin-windows/">previous guides</a> you’ve seen how to set up a project to develop a RhinoCommon Plugin or Grasshopper component. These guides relied on the Visual Studio Project Wizards that we publish to quickly get you going on plugin development. The wizards automatically reference the necessary assemblies to make RhinoCommon and Grasshopper SDKs available in your Visual Studio project. While this project setup should be fine for a number of cases, there might be some reasons to switch the RhinoCommon and Grasshopper assembly references to those which are published by <a href="https://www.nuget.org/profiles/McNeel">McNeel on NuGet</a>…</p>

<h3 id="advantages">Advantages</h3>

<p>There are several potential advantages to using NuGet packages for RhinoCommon SDKs:</p>

<ul>
  <li>It’s great for projects with multiple developers (or developers with multiple computers). No more references to <code>Grasshopper.dll</code> that include <code>C:\Users\&lt;username&gt;\AppData\...</code>.</li>
  <li>NuGet runs on Windows and Mac and is baked into Visual Studio (for both Window and Mac).</li>
  <li>Are you using Continuous Integration (CI)?  Your build servers can automatically download the correct version of the SDK before compiling and publishing your shiny new release.</li>
  <li>You’re probably already using it to install packages like <a href="https://www.nuget.org/packages/newtonsoft.json">Json.NET</a>.</li>
</ul>

<h3 id="potential-pitfalls">Potential Pitfalls</h3>

<p>NuGet makes it easy to compile plug-ins against versions of Rhino other than those installed on your computer. This is handy for backwards-compatible and/or cross-platform development. However, the fact that your Rhino installation and your RhinoCommon/Grasshopper references are “out of sync” can cause problems.</p>

<ul>
  <li>NuGet packages will need to be updated separately to Rhino</li>
  <li>You <em>may</em> have trouble debugging your plug-in if it was built against a version of RhinoCommon that is newer than the one included with Rhino<sup id="fnref:a"><a href="#fn:a" class="footnote">1</a></sup></li>
</ul>

<h2 id="getting-started">Getting Started</h2>

<div class="bs-callout">

<strong>Note</strong>: You may wish to read Microsoft's own guide to <a href="https://docs.microsoft.com/en-gb/nuget/quickstart/use-a-package">installing NuGet packages</a> in addition to this one.

</div>

<p>You can install the RhinoCommon package like you would any other.</p>

<p>The <a href="https://www.nuget.org/packages/rhinocommon">RhinoCommon</a> (for Rhino 5) package includes</p>

<ul>
  <li><em>RhinoCommon.dll</em></li>
</ul>

<p>The <a href="https://www.nuget.org/packages/grasshopper">Grasshopper</a> package depends<sup id="fnref:1"><a href="#fn:1" class="footnote">2</a></sup> on the RhinoCommon package <em>with the same version</em> and includes</p>

<ul>
  <li><em>Grasshopper.dll</em></li>
  <li><em>GH_IO.dll</em></li>
</ul>

<h3 id="step-by-step">Step-by-Step</h3>

<p>To switch to NuGet packages, follow these steps:</p>

<ol>
  <li>
    <p>In Visual Studio, find the <em>Solution Explorer</em> and right-click on the <em>References</em> section of your project. Select <em>Manage NuGet Packages…</em> Alternatively, the same can be done through the Visual Studio Project menu, and choosing <em>Manage NuGet Packages…</em></p>

    <p><img src="/5/images/switching-to-nuget-packages-01.png" alt="Manage NuGet Packages" /></p>
  </li>
  <li>
    <p>In the NuGet tab which appears, click on <em>Browse</em>. In the search box, type in <em>RhinoCommon</em>. You should see an entry for RhinoCommon and one for Grasshopper. If you are writing a Rhino Plugin or Grasshopper Add-on for Rhino WIP, ensure you check <em>Include prerelease</em>.</p>

    <p>If your project is a <strong>RhinoCommon Plugin</strong>, select the <a href="https://www.nuget.org/packages/rhinocommon">RhinoCommon</a> entry. For Rhino 5 plugins choose the <em>latest stable 5.12.*</em> version and click <em>Install</em>. NuGet will install<sup id="fnref:2"><a href="#fn:2" class="footnote">3</a></sup> <code>RhinoCommon.dll</code>.</p>

    <p>If your project is a <strong>Grasshopper Add-on</strong>, select the <a href="https://www.nuget.org/packages/grasshopper">Grasshopper</a> entry. For Grasshopper Add-ons on Rhino 5 choose the <em>latest stable 0.9.76</em> version and click <em>Install</em>. NuGet will install<sup id="fnref:2:1"><a href="#fn:2" class="footnote">3</a></sup> <code>Grasshopper.dll</code> and <code>GH_IO.dll</code> as well as the corresponding version of the RhinoCommon assemblies.</p>

    <p><img src="/5/images/switching-to-nuget-packages-02.png" alt="Choose NuGet Packages" /></p>
  </li>
  <li>
    <p><em>(Optional)</em> The references created by these packages have <code>CopyLocal</code> set to <code>true</code>.  Normally, it is a best practice to make sure that the references are not copied to the output directory, since they are included with Rhino. You can do this by selecting any of the following references if they exist in your project - <em>RhinoCommon</em>, <em>Eto</em>, <em>Rhino.UI</em>, <em>Grasshopper</em>, <em>GH_IO</em> - and, in the <em>Properties</em> window, set <code>CopyLocal</code> to <code>false</code>.  The reason this step is <em>optional</em> is that we’ve included some MSBuild witchcraft that will ensure that <code>CopyLocal</code> is set to <code>false</code> when compiling your project, regardless of what it says in the <em>Properties</em> window.</p>

    <p><img src="/5/images/switching-to-nuget-packages-03.png" alt="Copy Local" /></p>
  </li>
  <li>
    <p><em>(Optional)</em> If you’re using version control, don’t forget to commit the new <em>packages.config</em> file!</p>
  </li>
</ol>

<hr />

<h2 id="related-topics">Related Topics</h2>

<ul>
  <li><a href="/5/guides/rhinocommon/your-first-plugin-windows/">Your First Plugin (Windows)</a></li>
  <li><a href="/5/guides/rhinocommon/your-first-plugin-mac/">Your First Plugin (Mac)</a></li>
  <li><a href="/5/guides/rhinocommon/your-first-plugin-crossplatform/">Your First Plugin (Cross-Platform)</a></li>
</ul>

<hr />

<h2 id="footnotes">Footnotes</h2>

<div class="footnotes">
  <ol>
    <li id="fn:a">
      <p>Your plug-in will not load if it uses parts of the API which don’t exist in the running version of Rhino. <a href="#fnref:a" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:1">
      <p>This means that if you install the Grasshopper NuGet package, the matching RhinoCommon package will be installed automatically. <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>If your project already references one of the above assemblies, don’t worry! NuGet will handle it. <a href="#fnref:2" class="reversefootnote">&#8617;</a> <a href="#fnref:2:1" class="reversefootnote">&#8617;<sup>2</sup></a></p>
    </li>
  </ol>
</div>

        </article>

      <!--</div>-->

    </div>
</div>
</div>

        <!--/div-->
      </div>

      <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      
        <div class="row">
          <div class="col-md-4">

            <p class="text">
              
                Authors:
                <ul>
                  
                  
                    <li><a href="https://discourse.mcneel.com/users/fraguada/activity">Luis Fraguada</a></li>
                  
                    <li><a href="https://discourse.mcneel.com/users/will/activity">Will Pearson</a></li>
                  
                </ul>
              
            </p>
          </div>
          <div class="col-md-4 text-center">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <a href="https://github.com/mcneel/developer-rhino3d-com/blob/5/_guide_topics/rhinocommon/using-nuget.md" target="_blank">Edit page on GitHub</a>
          </div>
            <div class="col-md-4">
              <span class="pull-right">
                <span class="glyphicon glyphicon-cog"></span>&nbsp;<a href="/5/admin">Admin</a>
              </span>
            </div>
        </div>

        <div class="row text-center">
          © 1997 - 2019 Robert McNeel &amp; Associates
        </div>

      

    </div>

  </div>

  <script>
    if (navigator.appVersion.indexOf("Win")!=-1)
    {
      var body = document.getElementsByTagName("body");
      body[0].style.fontWeight = '400';
    }
  </script>

</footer>

    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- MathJax -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript">
    $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 150 /* fixed header is about 40px high */
    });
    </script>
    <!--
    Next block expands Bootstrap Collapse component when linked to it.  Used in rhinoscriptsyntax api docs
    ex: http://developer.rhino3d.com/api/RhinoScriptSyntax/win/#collapse-PointCompare
    -->
    <script type="text/javascript">
    $(document).ready(function () {
        if(document.title == 'rhinoscriptsyntax' && location.hash != null && location.hash != ""){
            $('.collapse').removeClass('in');
            $('#collapse-' + location.hash.split("-")[1] + '.collapse').collapse('show');
        }
    });
    </script>
  </body>

</html>
